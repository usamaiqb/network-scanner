package com.networkscanner.app.util

/**
 * MAC address vendor lookup using embedded OUI (Organizationally Unique Identifier) database.
 * Contains common device manufacturers for fast offline lookup.
 */
object MacVendorLookup {

    /**
     * Embedded OUI database with common manufacturers.
     * Format: OUI prefix (first 3 bytes) -> Vendor name
     */
    private val ouiDatabase: Map<String, String> = mapOf(
        // Apple
        "00:03:93" to "Apple",
        "00:05:02" to "Apple",
        "00:0A:27" to "Apple",
        "00:0A:95" to "Apple",
        "00:0D:93" to "Apple",
        "00:10:FA" to "Apple",
        "00:11:24" to "Apple",
        "00:14:51" to "Apple",
        "00:16:CB" to "Apple",
        "00:17:F2" to "Apple",
        "00:19:E3" to "Apple",
        "00:1B:63" to "Apple",
        "00:1C:B3" to "Apple",
        "00:1D:4F" to "Apple",
        "00:1E:52" to "Apple",
        "00:1E:C2" to "Apple",
        "00:1F:5B" to "Apple",
        "00:1F:F3" to "Apple",
        "00:21:E9" to "Apple",
        "00:22:41" to "Apple",
        "00:23:12" to "Apple",
        "00:23:32" to "Apple",
        "00:23:6C" to "Apple",
        "00:23:DF" to "Apple",
        "00:24:36" to "Apple",
        "00:25:00" to "Apple",
        "00:25:4B" to "Apple",
        "00:25:BC" to "Apple",
        "00:26:08" to "Apple",
        "00:26:4A" to "Apple",
        "00:26:B0" to "Apple",
        "00:26:BB" to "Apple",
        "00:30:65" to "Apple",
        "00:3E:E1" to "Apple",
        "00:50:E4" to "Apple",
        "00:56:CD" to "Apple",
        "00:61:71" to "Apple",
        "00:88:65" to "Apple",
        "00:B3:62" to "Apple",
        "00:C6:10" to "Apple",
        "00:CD:FE" to "Apple",
        "00:DB:70" to "Apple",
        "00:F4:B9" to "Apple",
        "00:F7:6F" to "Apple",
        "04:0C:CE" to "Apple",
        "04:15:52" to "Apple",
        "04:1E:64" to "Apple",
        "04:26:65" to "Apple",
        "04:4B:ED" to "Apple",
        "04:52:F3" to "Apple",
        "04:54:53" to "Apple",
        "04:D3:CF" to "Apple",
        "04:DB:56" to "Apple",
        "04:E5:36" to "Apple",
        "04:F1:3E" to "Apple",
        "04:F7:E4" to "Apple",

        // Samsung
        "00:00:F0" to "Samsung",
        "00:02:78" to "Samsung",
        "00:07:AB" to "Samsung",
        "00:09:18" to "Samsung",
        "00:0D:AE" to "Samsung",
        "00:0D:E5" to "Samsung",
        "00:12:47" to "Samsung",
        "00:12:FB" to "Samsung",
        "00:13:77" to "Samsung",
        "00:15:99" to "Samsung",
        "00:15:B9" to "Samsung",
        "00:16:32" to "Samsung",
        "00:16:6B" to "Samsung",
        "00:16:6C" to "Samsung",
        "00:17:C9" to "Samsung",
        "00:17:D5" to "Samsung",
        "00:18:AF" to "Samsung",
        "00:1A:8A" to "Samsung",
        "00:1B:98" to "Samsung",
        "00:1C:43" to "Samsung",
        "00:1D:25" to "Samsung",
        "00:1D:F6" to "Samsung",
        "00:1E:7D" to "Samsung",
        "00:1E:E1" to "Samsung",
        "00:1E:E2" to "Samsung",
        "00:1F:CC" to "Samsung",
        "00:1F:CD" to "Samsung",
        "00:21:4C" to "Samsung",
        "00:21:D1" to "Samsung",
        "00:21:D2" to "Samsung",
        "00:23:39" to "Samsung",
        "00:23:3A" to "Samsung",
        "00:23:99" to "Samsung",
        "00:23:D6" to "Samsung",
        "00:23:D7" to "Samsung",
        "00:24:54" to "Samsung",
        "00:24:90" to "Samsung",
        "00:24:91" to "Samsung",
        "00:25:66" to "Samsung",
        "00:25:67" to "Samsung",
        "00:26:37" to "Samsung",
        "00:26:5D" to "Samsung",
        "00:26:5F" to "Samsung",

        // Google
        "00:1A:11" to "Google",
        "1C:F2:9A" to "Google",
        "30:FD:38" to "Google",
        "3C:5A:B4" to "Google",
        "54:60:09" to "Google",
        "58:CB:52" to "Google",
        "5C:E9:31" to "Google",
        "94:EB:2C" to "Google",
        "98:D2:93" to "Google",
        "A4:77:33" to "Google",
        "F4:F5:D8" to "Google",
        "F4:F5:E8" to "Google",
        "F8:8F:CA" to "Google",

        // Amazon
        "00:FC:8B" to "Amazon",
        "0C:47:C9" to "Amazon",
        "10:AE:60" to "Amazon",
        "18:74:2E" to "Amazon",
        "34:D2:70" to "Amazon",
        "40:B4:CD" to "Amazon",
        "44:65:0D" to "Amazon",
        "50:F5:DA" to "Amazon",
        "68:37:E9" to "Amazon",
        "68:54:FD" to "Amazon",
        "74:C2:46" to "Amazon",
        "78:E1:03" to "Amazon",
        "84:D6:D0" to "Amazon",
        "A0:02:DC" to "Amazon",
        "AC:63:BE" to "Amazon",
        "B4:7C:9C" to "Amazon",
        "B4:A8:B9" to "Amazon",
        "CC:9E:A2" to "Amazon",
        "F0:27:2D" to "Amazon",
        "F0:81:73" to "Amazon",
        "FC:65:DE" to "Amazon",

        // Intel
        "00:02:B3" to "Intel",
        "00:03:47" to "Intel",
        "00:04:23" to "Intel",
        "00:07:E9" to "Intel",
        "00:0C:F1" to "Intel",
        "00:0E:0C" to "Intel",
        "00:0E:35" to "Intel",
        "00:11:11" to "Intel",
        "00:12:F0" to "Intel",
        "00:13:02" to "Intel",
        "00:13:20" to "Intel",
        "00:13:CE" to "Intel",
        "00:13:E8" to "Intel",
        "00:15:00" to "Intel",
        "00:15:17" to "Intel",
        "00:16:6F" to "Intel",
        "00:16:76" to "Intel",
        "00:16:EA" to "Intel",
        "00:16:EB" to "Intel",
        "00:17:35" to "Intel",
        "00:18:DE" to "Intel",

        // Microsoft
        "00:03:FF" to "Microsoft",
        "00:0D:3A" to "Microsoft",
        "00:12:5A" to "Microsoft",
        "00:15:5D" to "Microsoft",
        "00:17:FA" to "Microsoft",
        "00:1D:D8" to "Microsoft",
        "00:22:48" to "Microsoft",
        "00:25:AE" to "Microsoft",
        "00:50:F2" to "Microsoft",
        "28:18:78" to "Microsoft",
        "30:59:B7" to "Microsoft",
        "50:1A:C5" to "Microsoft",
        "58:82:A8" to "Microsoft",
        "60:45:BD" to "Microsoft",
        "7C:1E:52" to "Microsoft",
        "7C:ED:8D" to "Microsoft",
        "98:5F:D3" to "Microsoft",
        "B4:0E:DE" to "Microsoft",
        "C8:3F:26" to "Microsoft",
        "DC:B4:C4" to "Microsoft",

        // NETGEAR
        "00:09:5B" to "Netgear",
        "00:0F:B5" to "Netgear",
        "00:14:6C" to "Netgear",
        "00:18:4D" to "Netgear",
        "00:1B:2F" to "Netgear",
        "00:1E:2A" to "Netgear",
        "00:1F:33" to "Netgear",
        "00:22:3F" to "Netgear",
        "00:24:B2" to "Netgear",
        "00:26:F2" to "Netgear",
        "08:BD:43" to "Netgear",
        "10:0D:7F" to "Netgear",
        "10:0C:6B" to "Netgear",
        "20:4E:7F" to "Netgear",
        "28:C6:8E" to "Netgear",
        "2C:B0:5D" to "Netgear",
        "30:46:9A" to "Netgear",
        "44:94:FC" to "Netgear",
        "4C:60:DE" to "Netgear",

        // TP-Link
        "00:27:19" to "TP-Link",
        "14:CC:20" to "TP-Link",
        "14:CF:92" to "TP-Link",
        "18:A6:F7" to "TP-Link",
        "1C:3B:F3" to "TP-Link",
        "24:69:68" to "TP-Link",
        "30:B5:C2" to "TP-Link",
        "50:3E:AA" to "TP-Link",
        "50:C7:BF" to "TP-Link",
        "54:C8:0F" to "TP-Link",
        "5C:89:9A" to "TP-Link",
        "60:E3:27" to "TP-Link",
        "64:66:B3" to "TP-Link",
        "64:70:02" to "TP-Link",
        "6C:5A:B0" to "TP-Link",
        "70:4F:57" to "TP-Link",
        "78:A1:06" to "TP-Link",
        "90:F6:52" to "TP-Link",
        "94:D9:B3" to "TP-Link",
        "98:DA:C4" to "TP-Link",
        "A0:F3:C1" to "TP-Link",
        "AC:84:C6" to "TP-Link",
        "B0:4E:26" to "TP-Link",
        "B0:BE:76" to "TP-Link",
        "C0:25:E9" to "TP-Link",
        "C4:6E:1F" to "TP-Link",
        "C8:3A:35" to "TP-Link",
        "D4:6E:0E" to "TP-Link",
        "D8:07:B6" to "TP-Link",
        "D8:47:32" to "TP-Link",
        "E4:D3:32" to "TP-Link",
        "E8:DE:27" to "TP-Link",
        "EC:08:6B" to "TP-Link",
        "F4:EC:38" to "TP-Link",
        "F8:1A:67" to "TP-Link",

        // ASUS
        "00:0C:6E" to "ASUS",
        "00:0E:A6" to "ASUS",
        "00:11:2F" to "ASUS",
        "00:11:D8" to "ASUS",
        "00:13:D4" to "ASUS",
        "00:15:F2" to "ASUS",
        "00:17:31" to "ASUS",
        "00:18:F3" to "ASUS",
        "00:1A:92" to "ASUS",
        "00:1D:60" to "ASUS",
        "00:1E:8C" to "ASUS",
        "00:1F:C6" to "ASUS",
        "00:22:15" to "ASUS",
        "00:23:54" to "ASUS",
        "00:24:8C" to "ASUS",
        "00:25:22" to "ASUS",
        "00:26:18" to "ASUS",
        "04:92:26" to "ASUS",
        "08:60:6E" to "ASUS",
        "10:7B:44" to "ASUS",
        "10:BF:48" to "ASUS",
        "10:C3:7B" to "ASUS",
        "14:DA:E9" to "ASUS",
        "14:DD:A9" to "ASUS",

        // Cisco/Linksys
        "00:00:0C" to "Cisco",
        "00:01:42" to "Cisco",
        "00:01:43" to "Cisco",
        "00:01:63" to "Cisco",
        "00:01:64" to "Cisco",
        "00:01:96" to "Cisco",
        "00:01:97" to "Cisco",
        "00:01:C7" to "Cisco",
        "00:01:C9" to "Cisco",
        "00:02:16" to "Cisco",
        "00:02:17" to "Cisco",
        "00:02:3D" to "Cisco",
        "00:02:4A" to "Cisco",
        "00:02:4B" to "Cisco",
        "00:02:7D" to "Cisco",
        "00:02:7E" to "Cisco",
        "00:02:B9" to "Cisco",
        "00:02:BA" to "Cisco",
        "00:02:FC" to "Cisco",
        "00:02:FD" to "Cisco",
        "00:03:31" to "Cisco",
        "00:03:32" to "Cisco",

        // D-Link
        "00:05:5D" to "D-Link",
        "00:0D:88" to "D-Link",
        "00:0F:3D" to "D-Link",
        "00:11:95" to "D-Link",
        "00:13:46" to "D-Link",
        "00:15:E9" to "D-Link",
        "00:17:9A" to "D-Link",
        "00:19:5B" to "D-Link",
        "00:1B:11" to "D-Link",
        "00:1C:F0" to "D-Link",
        "00:1E:58" to "D-Link",
        "00:21:91" to "D-Link",
        "00:22:B0" to "D-Link",
        "00:24:01" to "D-Link",
        "00:26:5A" to "D-Link",
        "00:50:BA" to "D-Link",
        "14:D6:4D" to "D-Link",
        "1C:5F:2B" to "D-Link",
        "1C:7E:E5" to "D-Link",
        "28:10:7B" to "D-Link",

        // Sony
        "00:01:4A" to "Sony",
        "00:04:1F" to "Sony",
        "00:0A:D9" to "Sony",
        "00:0B:E3" to "Sony",
        "00:0D:CE" to "Sony",
        "00:0E:07" to "Sony",
        "00:0F:DE" to "Sony",
        "00:12:EE" to "Sony",
        "00:13:15" to "Sony",
        "00:13:A9" to "Sony",
        "00:15:C1" to "Sony",
        "00:16:20" to "Sony",
        "00:18:13" to "Sony",
        "00:19:63" to "Sony",
        "00:19:C5" to "Sony",
        "00:1A:80" to "Sony",
        "00:1B:59" to "Sony",
        "00:1D:28" to "Sony",
        "00:1D:BA" to "Sony",
        "00:1E:A4" to "Sony",
        "00:1F:E4" to "Sony",
        "00:21:9E" to "Sony",
        "00:22:98" to "Sony",
        "00:23:F1" to "Sony",
        "00:24:8D" to "Sony",
        "00:24:BE" to "Sony",

        // Dell
        "00:06:5B" to "Dell",
        "00:08:74" to "Dell",
        "00:0B:DB" to "Dell",
        "00:0D:56" to "Dell",
        "00:0F:1F" to "Dell",
        "00:11:43" to "Dell",
        "00:12:3F" to "Dell",
        "00:13:72" to "Dell",
        "00:14:22" to "Dell",
        "00:15:C5" to "Dell",
        "00:16:F0" to "Dell",
        "00:18:8B" to "Dell",
        "00:19:B9" to "Dell",
        "00:1A:A0" to "Dell",
        "00:1C:23" to "Dell",
        "00:1D:09" to "Dell",
        "00:1E:4F" to "Dell",
        "00:1E:C9" to "Dell",
        "00:21:70" to "Dell",
        "00:21:9B" to "Dell",
        "00:22:19" to "Dell",
        "00:23:AE" to "Dell",
        "00:24:E8" to "Dell",
        "00:25:64" to "Dell",
        "00:26:B9" to "Dell",

        // HP
        "00:01:E6" to "HP",
        "00:01:E7" to "HP",
        "00:02:A5" to "HP",
        "00:04:EA" to "HP",
        "00:08:02" to "HP",
        "00:08:83" to "HP",
        "00:0A:57" to "HP",
        "00:0B:CD" to "HP",
        "00:0D:9D" to "HP",
        "00:0E:7F" to "HP",
        "00:0F:20" to "HP",
        "00:0F:61" to "HP",
        "00:10:83" to "HP",
        "00:10:E3" to "HP",
        "00:11:0A" to "HP",
        "00:11:85" to "HP",
        "00:12:79" to "HP",
        "00:13:21" to "HP",
        "00:14:38" to "HP",
        "00:14:C2" to "HP",
        "00:15:60" to "HP",
        "00:16:35" to "HP",
        "00:17:08" to "HP",
        "00:17:A4" to "HP",
        "00:18:71" to "HP",
        "00:18:FE" to "HP",
        "00:19:BB" to "HP",

        // Lenovo
        "00:06:1B" to "Lenovo",
        "00:09:2D" to "Lenovo",
        "00:0A:E4" to "Lenovo",
        "00:12:FE" to "Lenovo",
        "00:16:D3" to "Lenovo",
        "00:1A:6B" to "Lenovo",
        "00:1C:25" to "Lenovo",
        "00:1E:37" to "Lenovo",
        "00:21:5C" to "Lenovo",
        "00:22:68" to "Lenovo",
        "00:24:7E" to "Lenovo",
        "00:26:2D" to "Lenovo",

        // Huawei
        "00:0F:E2" to "Huawei",
        "00:18:82" to "Huawei",
        "00:1E:10" to "Huawei",
        "00:21:E8" to "Huawei",
        "00:22:A1" to "Huawei",
        "00:25:68" to "Huawei",
        "00:25:9E" to "Huawei",
        "00:46:4B" to "Huawei",
        "00:5A:13" to "Huawei",
        "00:66:4B" to "Huawei",
        "00:9A:CD" to "Huawei",
        "00:E0:FC" to "Huawei",
        "04:02:1F" to "Huawei",
        "04:25:C5" to "Huawei",
        "04:27:58" to "Huawei",
        "04:33:89" to "Huawei",
        "04:75:03" to "Huawei",
        "04:B0:E7" to "Huawei",
        "04:BD:70" to "Huawei",
        "04:C0:6F" to "Huawei",
        "04:F9:38" to "Huawei",
        "04:FE:8D" to "Huawei",

        // Xiaomi
        "00:9E:C8" to "Xiaomi",
        "04:CF:8C" to "Xiaomi",
        "0C:1D:AF" to "Xiaomi",
        "10:2A:B3" to "Xiaomi",
        "14:F6:5A" to "Xiaomi",
        "18:59:36" to "Xiaomi",
        "20:F4:1B" to "Xiaomi",
        "28:6C:07" to "Xiaomi",
        "28:E3:1F" to "Xiaomi",
        "2C:D0:5A" to "Xiaomi",
        "34:80:B3" to "Xiaomi",
        "34:CE:00" to "Xiaomi",
        "38:A4:ED" to "Xiaomi",
        "3C:BD:3E" to "Xiaomi",
        "50:64:2B" to "Xiaomi",
        "58:44:98" to "Xiaomi",
        "64:09:80" to "Xiaomi",
        "64:B4:73" to "Xiaomi",
        "64:CC:2E" to "Xiaomi",
        "68:DF:DD" to "Xiaomi",
        "74:23:44" to "Xiaomi",
        "74:51:BA" to "Xiaomi",
        "78:02:F8" to "Xiaomi",
        "78:11:DC" to "Xiaomi",
        "7C:1D:D9" to "Xiaomi",
        "84:F3:EB" to "Xiaomi",

        // Raspberry Pi Foundation
        "28:CD:C1" to "Raspberry Pi",
        "B8:27:EB" to "Raspberry Pi",
        "DC:A6:32" to "Raspberry Pi",
        "E4:5F:01" to "Raspberry Pi",

        // Espressif (ESP32/ESP8266)
        "24:0A:C4" to "Espressif",
        "24:62:AB" to "Espressif",
        "24:6F:28" to "Espressif",
        "24:B2:DE" to "Espressif",
        "2C:3A:E8" to "Espressif",
        "30:AE:A4" to "Espressif",
        "3C:61:05" to "Espressif",
        "3C:71:BF" to "Espressif",
        "40:F5:20" to "Espressif",
        "4C:11:AE" to "Espressif",
        "5C:CF:7F" to "Espressif",
        "60:01:94" to "Espressif",
        "68:C6:3A" to "Espressif",
        "7C:9E:BD" to "Espressif",
        "84:0D:8E" to "Espressif",
        "84:CC:A8" to "Espressif",
        "84:F3:EB" to "Espressif",
        "8C:AA:B5" to "Espressif",
        "98:CD:AC" to "Espressif",
        "A0:20:A6" to "Espressif",
        "A4:7B:9D" to "Espressif",
        "A4:CF:12" to "Espressif",
        "AC:67:B2" to "Espressif",
        "B4:E6:2D" to "Espressif",
        "BC:DD:C2" to "Espressif",
        "C4:4F:33" to "Espressif",
        "CC:50:E3" to "Espressif",
        "D8:A0:1D" to "Espressif",
        "DC:4F:22" to "Espressif",
        "E8:DB:84" to "Espressif"
    )

    /**
     * Look up vendor name for a MAC address.
     * @param macAddress MAC address in any format (colons, hyphens, or no separators)
     * @return Vendor name or null if not found
     */
    fun lookup(macAddress: String?): String? {
        if (macAddress == null) return null

        val normalized = normalizeMac(macAddress)
        if (normalized.length < 8) return null

        // Get OUI (first 3 bytes)
        val oui = normalized.substring(0, 8)
        return ouiDatabase[oui]
    }

    /**
     * Normalize MAC address to uppercase with colons.
     */
    private fun normalizeMac(mac: String): String {
        // Remove all separators and convert to uppercase
        val cleaned = mac.uppercase().replace(Regex("[:-]"), "")
        if (cleaned.length < 6) return ""

        // Add colons between each pair
        return cleaned.chunked(2).joinToString(":")
    }

    /**
     * Check if a MAC address is from a known vendor.
     */
    fun isKnownVendor(macAddress: String?): Boolean {
        return lookup(macAddress) != null
    }

    /**
     * Get all vendors matching a search term.
     */
    fun searchVendors(query: String): List<Pair<String, String>> {
        val lowerQuery = query.lowercase()
        return ouiDatabase.filter { (_, vendor) ->
            vendor.lowercase().contains(lowerQuery)
        }.map { (oui, vendor) -> oui to vendor }
    }
}
